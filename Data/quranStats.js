let surahInfo = [{
    id: 1,
    name: "al-Fātiḥah",
    pagestart: 1,
    finishline: 15
},
{
    id: 2,
    name: "al-Baq̈arah",
    pagestart: 2,
    finishline: 15
},
{
    id: 3,
    name: "ʾāli-ʿImrān",
    pagestart: 50,
    finishline: 15
},
{
    id: 4,
    name: "an-Nisāʾ",
    pagestart: 77,
    finishline: 7
},
{
    id: 5,
    name: "al-Māʾidah",
    pagestart: 106,
    finishline: 15
},
{
    id: 6,
    name: "al-ʾAnʿām",
    pagestart: 128,
    finishline: 15
},
{
    id: 7,
    name: "al-ʾAʿrāf",
    pagestart: 151,
    finishline: 15
},
{
    id: 8,
    name: "al-ʾAnfāl",
    pagestart: 177,
    finishline: 15
},
{
    id: 9,
    name: "at-Tawbah",
    pagestart: 187,
    finishline: 15
},
{
    id: 10,
    name: "Yūnus",
    pagestart: 208,
    finishline: 8
},
{
    id: 11,
    name: "Hūd",
    pagestart: 221,
    finishline: 10
},
{
    id: 12,
    name: "Yūsuf",
    pagestart: 235,
    finishline: 15
},
{
    id: 13,
    name: "ar-Raʿd",
    pagestart: 249,
    finishline: 4
},
{
    id: 14,
    name: "ʾIbrāhīm",
    pagestart: 255,
    finishline: 15
},
{
    id: 15,
    name: "al-Ḥijr",
    pagestart: 262,
    finishline: 8
},
{
    id: 16,
    name: "an-Naḥl",
    pagestart: 267,
    finishline: 15
},
{
    id: 17,
    name: "al-ʾIsrāʾ",
    pagestart: 282,
    finishline: 11
},
{
    id: 18,
    name: "al-Kahf",
    pagestart: 293,
    finishline: 15
},
{
    id: 19,
    name: "Maryam",
    pagestart: 305,
    finishline: 6
},
{
    id: 20,
    name: "ṬāHā",
    pagestart: 312,
    finishline: 15
},
{
    id: 21,
    name: "al-ʾAnbiyāʾ",
    pagestart: 322,
    finishline: 15
},
{
    id: 22,
    name: "al-Ḥajj",
    pagestart: 332,
    finishline: 15
},
{
    id: 23,
    name: "al-Muʾminūn",
    pagestart: 342,
    finishline: 15
},
{
    id: 24,
    name: "an-Nūr",
    pagestart: 350,
    finishline: 12
},
{
    id: 25,
    name: "al-Furq̈ān",
    pagestart: 359,
    finishline: 15
},
{
    id: 26,
    name: "aš-Šuʿarāʾ",
    pagestart: 367,
    finishline: 15
},
{
    id: 27,
    name: "an-Naml",
    pagestart: 377,
    finishline: 9
},
{
    id: 28,
    name: "al-Q̈aṣaṣ",
    pagestart: 385,
    finishline: 9
},
{
    id: 29,
    name: "al-ʿAnkabūt",
    pagestart: 396,
    finishline: 11
},
{
    id: 30,
    name: "ar-Rūm",
    pagestart: 404,
    finishline: 15
},
{
    id: 31,
    name: "Luq̈mān",
    pagestart: 411,
    finishline: 15
},
{
    id: 32,
    name: "as-Sajdah",
    pagestart: 415,
    finishline: 15
},
{
    id: 33,
    name: "al-ʾAḥzāb",
    pagestart: 418,
    finishline: 15
},
{
    id: 34,
    name: "Sabaʾ",
    pagestart: 428,
    finishline: 9
},
{
    id: 35,
    name: "Fāṭir",
    pagestart: 434,
    finishline: 5
},
{
    id: 36,
    name: "YāSīn",
    pagestart: 440,
    finishline: 15
},
{
    id: 37,
    name: "aṣ-Ṣāffāt",
    pagestart: 446,
    finishline: 15
},
{
    id: 38,
    name: "Ṣād",
    pagestart: 453,
    finishline: 5
},
{
    id: 39,
    name: "az-Zumar",
    pagestart: 458,
    finishline: 4
},
{
    id: 40,
    name: "Ghāfir",
    pagestart: 467,
    finishline: 15
},
{
    id: 41,
    name: "Fuṣṣilat",
    pagestart: 477,
    finishline: 15
},
{
    id: 42,
    name: "aš-Šūrā",
    pagestart: 483,
    finishline: 6
},
{
    id: 43,
    name: "az-Zukhruf",
    pagestart: 489,
    finishline: 15
},
{
    id: 44,
    name: "ad-Dukhān",
    pagestart: 496,
    finishline: 15
},
{
    id: 45,
    name: "al-Jāthiyah",
    pagestart: 499,
    finishline: 8
},
{
    id: 46,
    name: "al-ʾAḥq̈āf",
    pagestart: 502,
    finishline: 15
},
{
    id: 47,
    name: "Muḥammad",
    pagestart: 507,
    finishline: 15
},
{
    id: 48,
    name: "al-Fatḥ",
    pagestart: 511,
    finishline: 8
},
{
    id: 49,
    name: "al-Ḥujurāt",
    pagestart: 515,
    finishline: 15
},
{
    id: 50,
    name: "Q̈āf",
    pagestart: 518,
    finishline: 13
},
{
    id: 51,
    name: "aḏ-Ḏāriyāt",
    pagestart: 520,
    finishline: 9
},
{
    id: 52,
    name: "aṭ-Ṭūr",
    pagestart: 523,
    finishline: 15
},
{
    id: 53,
    name: "an-Najm",
    pagestart: 526,
    finishline: 11
},
{
    id: 54,
    name: "al-Q̈amar",
    pagestart: 528,
    finishline: 6
},
{
    id: 55,
    name: "ar-Raḥmān",
    pagestart: 531,
    finishline: 8
},
{
    id: 56,
    name: "al-Wāqiʿah",
    pagestart: 534,
    finishline: 12
},
{
    id: 57,
    name: "al-Ḥadīd",
    pagestart: 537,
    finishline: 15
},
{
    id: 58,
    name: "al-Mujādilah",
    pagestart: 542,
    finishline: 8
},
{
    id: 59,
    name: "al-Ḥašr",
    pagestart: 545,
    finishline: 15
},
{
    id: 60,
    name: "al-Mumtaḥanah",
    pagestart: 549,
    finishline: 8
},
{
    id: 61,
    name: "aṣ-Ṣaff",
    pagestart: 551,
    finishline: 15
},
{
    id: 62,
    name: "al-Jumuʿah",
    pagestart: 553,
    finishline: 8
},
{
    id: 63,
    name: "al-Munāfiq̈ūn",
    pagestart: 554,
    finishline: 15
},
{
    id: 64,
    name: "at-Taghābun",
    pagestart: 556,
    finishline: 15
},
{
    id: 65,
    name: "aṭ-Ṭalāq̈",
    pagestart: 558,
    finishline: 15
},
{
    id: 66,
    name: "at-Taḥrīm",
    pagestart: 560,
    finishline: 15
},
{
    id: 67,
    name: "al-Mulk",
    pagestart: 562,
    finishline: 7
},
{
    id: 68,
    name: "al-Q̈alam",
    pagestart: 564,
    finishline: 11
},
{
    id: 69,
    name: "al-Ḥāq̈q̈ah",
    pagestart: 566,
    finishline: 10
},
{
    id: 70,
    name: "al-Maʿārij",
    pagestart: 568,
    finishline: 6
},
{
    id: 71,
    name: "Nūḥ",
    pagestart: 570,
    finishline: 15
},
{
    id: 72,
    name: "al-Jinn",
    pagestart: 572,
    finishline: 15
},
{
    id: 73,
    name: "al-Muzzammil",
    pagestart: 574,
    finishline: 9
},
{
    id: 74,
    name: "al-Muddathir",
    pagestart: 575,
    finishline: 7
},
{
    id: 75,
    name: "al-Q̈iyamah",
    pagestart: 577,
    finishline: 11
},
{
    id: 76,
    name: "al-ʾInsān",
    pagestart: 578,
    finishline: 8
},
{
    id: 77,
    name: "al-Mursalāt",
    pagestart: 580,
    finishline: 15
},
{
    id: 78,
    name: "an-Nabaʾ",
    pagestart: 582,
    finishline: 9
},
{
    id: 79,
    name: "an-Nāziʿāt",
    pagestart: 583,
    finishline: 15
},
{
    id: 80,
    name: "ʿAbasa",
    pagestart: 585,
    finishline: 3
},
{
    id: 81,
    name: "at-Takwīr",
    pagestart: 586,
    finishline: 15
},
{
    id: 82,
    name: "al-ʾInfiṭār",
    pagestart: 587,
    finishline: 13
},
{
    id: 83,
    name: "al-Muṭaffifīn",
    pagestart: 587,
    finishline: 4
},
{
    id: 84,
    name: "al-ʾInšiq̈āq̈",
    pagestart: 589,
    finishline: 3
},
{
    id: 85,
    name: "al-Burūj",
    pagestart: 590,
    finishline: 15
},
{
    id: 86,
    name: "aṭ-Ṭāriq̈",
    pagestart: 591,
    finishline: 11
},
{
    id: 87,
    name: "al-ʾAʿlā",
    pagestart: 591,
    finishline: 6
},
{
    id: 88,
    name: "al-Ghāšiyah",
    pagestart: 592,
    finishline: 4
},
{
    id: 89,
    name: "al-Fajr",
    pagestart: 593,
    finishline: 7
},
{
    id: 90,
    name: "al-Balad",
    pagestart: 594,
    finishline: 3
},
{
    id: 91,
    name: "aš-Šams",
    pagestart: 595,
    finishline: 12
},
{
    id: 92,
    name: "al-Layl",
    pagestart: 595,
    finishline: 7
},
{
    id: 93,
    name: "aḍ-Ḍuḥā",
    pagestart: 596,
    finishline: 14
},
{
    id: 94,
    name: "aš-Šarḥ",
    pagestart: 596,
    finishline: 4
},
{
    id: 95,
    name: "at-Tīn",
    pagestart: 597,
    finishline: 10
},
{
    id: 96,
    name: "al-ʿAlaq̈",
    pagestart: 597,
    finishline: 5
},
{
    id: 97,
    name: "al-Q̈adr",
    pagestart: 598,
    finishline: 10
},
{
    id: 98,
    name: "al-Bayyinah",
    pagestart: 598,
    finishline: 7
},
{
    id: 99,
    name: "Az-Zalzalah",
    pagestart: 599,
    finishline: 13
},
{
    id: 100,
    name: "al-ʿĀdiyāt",
    pagestart: 599,
    finishline: 5
},
{
    id: 101,
    name: "al-Q̈āriʿah",
    pagestart: 600,
    finishline: 12
},
{
    id: 102,
    name: "at-Takāthur",
    pagestart: 600,
    finishline: 15
},
{
    id: 103,
    name: "al-ʿAṣr",
    pagestart: 601,
    finishline: 6
},
{
    id: 104,
    name: "al-Humazah",
    pagestart: 601,
    finishline: 12
},
{
    id: 105,
    name: "al-Fīl",
    pagestart: 601,
    finishline: 15
},
{
    id: 106,
    name: "Q̈urayš",
    pagestart: 602,
    finishline: 7
},
{
    id: 107,
    name: "al-Maʿūn",
    pagestart: 602,
    finishline: 13
},
{
    id: 108,
    name: "al-Kawthar",
    pagestart: 602,
    finishline: 15
},
{
    id: 109,
    name: "al-Kāfirūn",
    pagestart: 603,
    finishline: 7
},
{
    id: 110,
    name: "an-Naṣr",
    pagestart: 603,
    finishline: 12
},
{
    id: 111,
    name: "al-Masad",
    pagestart: 603,
    finishline: 15
},
{
    id: 112,
    name: "al-ʾIkhlāṣ",
    pagestart: 604,
    finishline: 6
},
{
    id: 113,
    name: "al-Falaq̈",
    pagestart: 604,
    finishline: 11
},
{
    id: 114,
    name: "an-Nās",
    pagestart: 604,
    finishline: 15
}
];

let juzEndPages = [
    21, 41, 61, 81, 101, 121, 141, 161, 181, 201, 221, 241, 261, 281, 301, 321, 341, 361, 381, 401, 421, 441, 461, 481, 501, 521, 541, 561, 581, 604
];

let startPageOfSurahs = surahInfo.map(x => x.pagestart);
let endLineOfSurahs = surahInfo.map(x => x.finishline);


function convertFromPages(pages) {   //prends en entree un tabeau de pages comme celui affiche dans le mushaf
    // pages = pages.map(x=>x-=1); // facilite l'utilisation
    let lowestPage = Math.min(...pages);
    let highestPage = Math.max(...pages);
    let possibleCorrespondingSurahs = [];
    let correspondingSurahs = [];
    let possibleCorrespondingJuzs = [];
    let correspondingJuzs = [];

    //getting Surahs
    for (let i = 0, length = startPageOfSurahs.length, isStarted = false, isFinished = false; i < length && (!isStarted || !isFinished); i++) {
        if (!isStarted) {
            if (startPageOfSurahs[i] >= lowestPage) {
                isStarted = true;
                possibleCorrespondingSurahs.push(i);
            }
        } else {
            if (!(startPageOfSurahs[i] > highestPage)) {
                possibleCorrespondingSurahs.push(i);
            } else {
                isFinished = true;
            }
        }
    }
    for (let i = 0, length = possibleCorrespondingSurahs.length; i < length; i++) {
        let lowerInterval = startPageOfSurahs[possibleCorrespondingSurahs[i]];
        let higherInterval = (possibleCorrespondingSurahs[i] + 1) !== 114 /*outofbound*/ ? startPageOfSurahs[possibleCorrespondingSurahs[i] + 1] : 604;
        let higherIntervalIsInclusive = endLineOfSurahs[possibleCorrespondingSurahs[i]] !== 15;

        let surahIsPresent = true;
        for (let j = 0, length = (higherInterval - lowerInterval) + (higherIntervalIsInclusive ? 1 : 0); j < length && surahIsPresent; j++) {
            if (!pages.some(x => x === lowerInterval + j)) {
                surahIsPresent = false;
            }
        }
        if (surahIsPresent) {
            correspondingSurahs.push(possibleCorrespondingSurahs[i]);
        }
    }

    //getting Juz
    for (let i = 0, length = juzEndPages.length, isFinished = false; i < length && !isFinished; i++) {
        if (juzEndPages[i] <= highestPage) {
            possibleCorrespondingJuzs.push(i);
        } else {
            isFinished = true;
        }
    }
    for (let i = 0, length = possibleCorrespondingJuzs.length; i < length; i++) {
        let lowerInterval = i !== 0 ? /*the first juz*/ juzEndPages[possibleCorrespondingJuzs[i - 1]] : 0;
        let higherInterval = juzEndPages[possibleCorrespondingJuzs[i]];
        let juzIsPresent = true;
        for (let j = 0, length = (higherInterval - lowerInterval); j < length && juzIsPresent; j++) {
            if (!pages.some(x => x === lowerInterval + j + 1)) {
                juzIsPresent = false;
            }
        }
        if (juzIsPresent) {
            correspondingJuzs.push(i);
        }
    }

    return [correspondingJuzs, correspondingSurahs];

}

function convertFromSurahs(surahs) {  //donner en argument tableau des numeros des sourates -1

    surahs = surahs.slice();
    surahs.sort((a, b) => a - b);
    let correspondingPages = [];

    for (let i = 0, length = surahs.length; i < length; i++) {

        const getSurahsWithSameStartPage = (page) => {
            let surahsWithSameStartPage = [];
            startPageOfSurahs.forEach((x, i) => { if (x === page) surahsWithSameStartPage.push(i); });
            return surahsWithSameStartPage;
        }

        //verifier si on doit rajouter la page de commencement d'un sourate donnée
        if (surahs[i] !== 0) {

            if (endLineOfSurahs[surahs[i] - 1] !== 15) {    //Le dernier verset de la sourate n'est pas à la fin de la page
                if (getSurahsWithSameStartPage(startPageOfSurahs[surahs[i]]).every(i => surahs.includes(i))) {
                    correspondingPages.push(startPageOfSurahs[surahs[i]]);
                }
            } else {
                if (getSurahsWithSameStartPage(startPageOfSurahs[surahs[i]]).length === 1) {
                    correspondingPages.push(startPageOfSurahs[surahs[i]]);
                }
            }
        }

        //rajouter milieu
        if (surahs[i] + 1 < 114) {
            for (let j = startPageOfSurahs[surahs[i]] + 1, length = startPageOfSurahs[surahs[i] + 1] - 1; j <= length; j++) {
                correspondingPages.push(j);
            }
            ///verifier si on doit rajouter la page de fin d'un sourate donnée 
            if (endLineOfSurahs[surahs[i]] !== 15) {

                let surahsWithSameStartPage = getSurahsWithSameStartPage(startPageOfSurahs[surahs[i] + 1]);
                let endIncluded = true;
                for (let j = 0, length = surahsWithSameStartPage.length; j < length; j++) {
                    if (!(surahs.some(x => x === (surahs[i] + 1 + j)))) {
                        endIncluded = false;
                    }
                }
                if (endIncluded) {
                    correspondingPages.push(startPageOfSurahs[surahs[i] + 1]);      //rajoute la première page de la sourate suivante
                }

            } else {
                correspondingPages.push(startPageOfSurahs[surahs[i] + 1] - 1);
            }

        }

    }

    correspondingPages = [...new Set(correspondingPages)];  //enlever les éléments dupliqués

    return [convertFromPages(correspondingPages)[0], correspondingPages];
}

function convertFromJuzs(juzs) {
    juzs = juzs.slice();
    juzs.sort((a, b) => a - b);
    let correspondingPages = [];

    for (let i = 0, length = juzs.length; i < length; i++) {
        if (juzs[i] !== 0) {
            for (let j = juzEndPages[juzs[i] - 1], length = juzEndPages[juzs[i]]; j < length; j++) {
                correspondingPages.push(j);
            }
        } else {
            correspondingPages.push(...Array(21).keys());
        }
    }
    correspondingPages = correspondingPages.map(x => x + 1);
    return [convertFromPages(correspondingPages)[1], correspondingPages];
}

export { surahInfo, convertFromJuzs, convertFromPages, convertFromSurahs };